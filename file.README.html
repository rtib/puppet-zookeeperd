<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.18
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-zookeeperd">zookeeperd</h1>

<p><a href="https://travis-ci.org/rtib/puppet-zookeeperd"><img
src="https://travis-ci.org/rtib/puppet-zookeeperd.svg?branch=master"></a>
<a href="https://github.com/rtib/puppet-zookeeperd/issues"><img
src="https://img.shields.io/github/issues/rtib/puppet-zookeeperd.svg"></a>
<a
href="https://raw.githubusercontent.com/rtib/puppet-zookeeperd/master/LICENSE"><img
src="https://img.shields.io/badge/license-Apache%202-blue.svg"></a></p>

<h4 id="label-Table+of+Contents">Table of Contents</h4>
<ul><li>
<p><a href="#label-Zookeeperd">zookeeperd</a></p>
<ul><li>
<p><a href="#label-Table+of+contents">Table of Contents</a></p>
</li></ul>
</li><li>
<p><a href="#label-Description">Description</a></p>
</li><li>
<p><a href="#label-Setup">Setup</a></p>
<ul><li>
<p><a href="#label-Setup+requirements">Setup Requirements</a></p>
</li><li>
<p><a href="#label-Beginning+with+zookeeperd">Beginning with zookeeperd</a></p>
</li></ul>
</li><li>
<p><a href="#label-Usage">Usage</a></p>
<ul><li>
<p><a href="#label-Automatic+cluster+configuration">Automatic cluster
configuration</a></p>
</li><li>
<p><a href="#label-Manual+configuration">Manual configuration</a></p>
</li><li>
<p><a href="#label-Zookeeper+maintenance">Zookeeper maintenance</a></p>
</li><li>
<p><a href="#label-Using+zookeeperd+fact">Using zookeeperd fact</a></p>
</li></ul>
</li><li>
<p><a href="#label-Configuration">Configuration</a></p>
<ul><li>
<p><a href="#label-Zoocfg">zoo.cfg</a></p>
</li></ul>
</li><li>
<p><a href="#label-Reference">Reference</a></p>
</li><li>
<p><a href="#label-Limitations">Limitations</a></p>
</li><li>
<p><a href="#label-Development">Development</a></p>
</li><li>
<p><a href="#label-Donate">Donate</a></p>
</li></ul>

<h2 id="label-Description">Description</h2>

<p>Yet another puppet module configuring zookeeper …</p>

<p>Unique with this module are two features making the usually very painful
zookeeper configuration as easy as it can be. First, as all zookeeper nodes
need a unique ID to be given, this module provides a custom fact which
calculatint a suitable value. Second, all zookeeper nodes need to get the
list of all nodes belonging to its ensamble. By making use of puppet&#39;s
exported resource feature, node definitions are exported and collected to
building the server list. Utilizing both features will automate zookeeper
configuration and eliminate the node ID and the list of servers from your
puppet manifests and hiera.</p>

<h2 id="label-Setup">Setup</h2>

<h3 id="label-Setup+Requirements">Setup Requirements</h3>

<p>It is presumed that zookeeper packages are available on your system via
regular package management. This module won&#39;t configure any package
management repositories.</p>

<p>Pluginsync needs to be enabled on your puppet deployment in order to get
the custom fact working.</p>

<p>Stored config needs to be enabled on your puppetmaster infrastructure in
order to get autoconfiguration feature working. Also, it is strongly
recommended to use PuppetDB and consider it as a critical part of your
configuration management system. Be aware, that manipulation, inconsistency
and data loss from your PuppetDB may cause this module to disrupt your
zookeeper clusters.</p>

<h3 id="label-Beginning+with+zookeeperd">Beginning with zookeeperd</h3>

<p>Install the module and its dependencies to your environment. Include the
module to your manifests. You may utilize hiera to hold configuration
parameter. The module carries most of its default values using hiera in
module, which also serve as an example.</p>

<h2 id="label-Usage">Usage</h2>

<h3 id="label-Automatic+cluster+configuration">Automatic cluster configuration</h3>

<p>This module enables to automatically create the configurations of zookeeper
instances belonging to the same ensamble. To do so, enable
autoconfiguration and set an ensamble name on all nodes of the cluster.</p>

<pre class="code ruby"><code class="ruby">class{ zookeeperd:
  ensamble          =&gt; &#39;Awesamly easy way to your zookeeper cluster&#39;,
  enable_autoconfig =&gt; true,
}
````

This will install zookeeper to all nodes this manifest applies to and configure all instances having the same ensamble name to one cluster. Note, that puppet needs at least two runs to get the configuration ready: the first run will export the node definitions, the second will collect all nodes. This is done by exporting</code></pre>

<p>zookeeperd::node<code>resources tagged with their ensamble and collecting
the same resources having the matching ensamble tag.
Each</code>zookeeperd::node<code>resource will create one</code>server“`
entry in the zoo.cfg configuration telling zookeeper the list of nodes
within the cluster.</p>

<h3 id="label-Manual+configuration">Manual configuration</h3>

<p>If you don&#39;t trust your PuppetDB, or does not want stored configs on
your PupppetMaster, you may add pass the list of nodes to the module
through nodes parameter.</p>

<pre class="code ruby"><code class="ruby">class{ zookeeperd:
  myid  =&gt; $id_of_this_node,
  nodes =&gt; {
    &#39;first&#39; =&gt; {
      nodeid =&gt; 1,
      nodename =&gt; &#39;first.zk.example.org&#39;,
    },
    &#39;second&#39; =&gt; {
      nodeid =&gt; 2,
      nodename =&gt; &#39;first.zk.example.org&#39;,
    }
  }
}
````

### Zookeeper maintenance

As zookeeper needs maintenance to cleanup logs and snapshots this module provides a systemd service unit invoking the cleanup and a timer unit scheduling it. You may or may not like zookeepers internal maintenance scheduler, which you can configure via</code></pre>

<p>zookeeperd::config“`.</p>

<p>By default, this module will create a systemd service unit called
<code>zookeeper-cleanup.service</code> which does the maintenance and a
timer unit <code>zookeeper-cleanup.timer</code> triggering a previous on a
schedule.</p>

<h3 id="label-Using+zookeeperd+fact">Using zookeeperd fact</h3>

<p>The module provides a custom fact which calculates a unique ID for all
nodes. This fact is available
<code>$facts['zookeeperd'][&#39;myid&#39;]</code>. The myid parameter of
the module defaults to this value. The value is calculated from the IP
address (<code>$facts['networking'][&#39;ip]</code>) of the node by
converting it to a 32 bit integer.</p>

<p>Zookeeper documentation, however, states myid must between 1..255, the
software itself is treating this as unsigned long, and it is not used for
any logic nor arithmetic.</p>

<h2 id="label-Configuration">Configuration</h2>

<h3 id="label-zoo.cfg">zoo.cfg</h3>

<p>The main configuration file of zookeeper, the zoo.cfg is created by taking
key-value pairs from <code>zookeeperd::config</code> hash. The module
proves default values with the minimum parameters needed for zookeeper.</p>

<h2 id="label-Reference">Reference</h2>

<p>The module code is documented using puppet-strings. Visit <a
href="https://rtib.github.io/puppet-zookeeperd">rtib.github.io/puppet-zookeeperd</a>/
to access detailed code documentation.</p>

<h2 id="label-Limitations">Limitations</h2>

<p>This is where you list OS compatibility, version compatibility, etc. If
there are Known Issues, you might want to include them under their own
heading here.</p>

<h2 id="label-Development">Development</h2>

<p>Puppet modules on the Puppet Forge are open projects, and community
contributions are essential for keeping them great. Please follow the usual
guidelines when contributing changes. 1. fork the repository on GitHub 2.
make your improvements, preferably to a feature branch 3. rebase your
changes to the head of the master branch 4. squash your changes into a
single commit 5. file a pull request and check the result of Travis-CI
tests</p>

<h2 id="label-Donate">Donate</h2>

<p>If you like this project feel free to support via Bitcoin <a
href="bitcoin:3Cmcvt2zZ4owgW6SBUMXHkNvJu4mq6GoNu?label=donate%3A%20PuppetForge%20trepasi%20zookeeperd"><img
src="https://github.com/rtib/puppet-zookeeperd/raw/master/donate.png"></a></p>
</div></div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>